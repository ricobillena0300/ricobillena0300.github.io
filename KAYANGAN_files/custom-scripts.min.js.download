jQuery(document).ready(function( $ ) {

	"use strict";
	
	// Sticky Sidebar
	function stickySidebar() {
		if ($( '.main-sidebar' ).data('effect') === 1 ) {

			var SidebarOffset = 0;

			if ( $('.fixed-header-bottom').length ) {
				SidebarOffset = 95;
			}

			$('.main-sidebar').stick_in_parent({
				parent: ".main-container-inner",
				offset_top: SidebarOffset,
				spacer: '.main-sidebar-wrap'
			});

			if ( $('.responsive-column').css('display') === 'none' ) {
				$('.main-sidebar').trigger("sticky_kit:detach");
			}
		}
	}

	$( window ).resize(function() {
		stickySidebar();
	});

	$( window ).load(function() {
		stickySidebar();
	});

	// Fixed Sidebar Scroll
	$('.fixed-sidebar').perfectScrollbar({
		suppressScrollX : true,
		includePadding : true,
		wheelSpeed: 3.5
	});

	// Responsive Menu 
	$( '.nav-mobile .menu-item-has-children' ).prepend( '<div class="sub-menu-btn"></div>' );
	$('.nav-mobile .sub-menu').before( '<span class="sub-menu-btn-icon"><i class="fa fa-sort-desc"></i></span>' );

	//Responsive sub-menu btn
	$('.sub-menu-btn').click(function(){
		$(this).closest('li').children('.sub-menu').slideToggle();
		$(this).closest('li').children('.sub-menu-btn-icon').children('i').toggleClass( 'fa-rotate-270' );
	});

	// Admin Bar Height
	var adminBar = 0;
	if ( $('body').hasClass('admin-bar') ) {
		adminBar = 32;
	}

	// Navigation Hover 
	$('.top-nav,.nav').find('li').hover(function () {
	    $(this).children('.sub-menu').stop().fadeIn( 200 );
	}, function() {
		$(this).children('.sub-menu').stop().fadeOut( 200 );
	});

	// Resposive Nav Menu btn
	$('.nav-btn').click(function(){
		$( ".nav-mobile" ).slideToggle( "slow" );
	});

	$( window ).resize(function() {
		if ($('.nav-btn').css('display') == 'none' ) {
			$( '.nav-mobile' ).css({'display':'none'});
	 	}
	});

	var postColumn = $('.main-container-wrap').data('current-layout');
	// Rresponsive Layout
	function infinityResponsiveColumn(){
		if ( $('.responsive-column').css('display') !== 'none' && $('.responsive-column').css('opacity') !== '0' ) {
			postColumn = $('.main-container-wrap').data('current-layout');
		}

		if ( $('.responsive-column').css('display') === 'none' ) {
			postColumn = 'col2';

		}
		if ( $('.responsive-column').css('opacity') === '0' ) {
			postColumn = 'full';
		}
	}
	
	infinityResponsiveColumn();
	infinityGrid();
	$( window ).resize(function() {
		infinityResponsiveColumn();
		infinityGrid();
	});

	$( window ).load(function() {
		infinityResponsiveColumn();
		infinityGrid();
	});

	function infinityGrid() {
		if ( postColumn === 'col3' ) {
			$('.infinity-grid li').removeClass('col2');
			$('.infinity-grid li').addClass('col3');
		}

		if ( postColumn === 'col2' ) {
			$('.infinity-grid li').removeClass('col3');;
			$('.infinity-grid li').addClass('col2');
		}

		if (  postColumn === 'full' ) {
			$('.infinity-grid li').removeClass('col3').removeClass('col2');
			
		}

		if( $('.main-container-wrap').data('current-layout') === 'list' ) {
			if( postColumn === 'full' ) {
				$('.infinity-list li').removeClass('list');
			} else {
				$('.infinity-list li').addClass('list');
			}		
		}
	}
	
	// FitVids Size
	$('.entry-video,.entry-content p').fitVids();

	// Click event to scroll to top
	$('.backtotop').click(function(){
		$('html, body').animate( { scrollTop : 0},800);
		return false;
	});

	// Fixed Menu
	var headerHeight = $('.header-bottom').offset().top - adminBar;
	$(window).scroll( function(){
		if ( $(this).scrollTop() >= headerHeight ) {
			$('.fixed-header-bottom').css('display','block');
		} else {
			$('.fixed-header-bottom').css('display','none');
		}

		if ( $(this).scrollTop() >= headerHeight  + 160 ) {
			$('.mini-logo').fadeIn(400);
		} else {
			$('.mini-logo').fadeOut(300);
		}
	});

	var	sldrItems = $('.infinity-carousel-wrap').data('columns'),
		sldrAutoplay = $('.infinity-carousel-wrap').data('autoplay'),
		sldrAutoplayTimeout = 0,
		sldrLoop = ($('.infinity-carousel-wrap').data('loop') === 1 && $('.infinity-carousel').children().length > 1 )? true: false,
		sldrMargin = $('.infinity-carousel-wrap').data('margin'),
		sldrStagePadding = $('.infinity-carousel-wrap').data('stagepadding'),
		sldrNavigation = ($('.infinity-carousel-wrap').data('navigation') !== 'off' )? true: false,
		sldrPagination = ($('.infinity-carousel-wrap').data('pagination') === 1 )? true: false,
		sldrslideby = $('.infinity-carousel-wrap').data('slideby'),
		sldrItemsDesktop = 2,
		sldrItemsTablet = 2;

	if (  sldrItems > 0 ) {
	
		if (sldrAutoplay === 0 ) {
			sldrAutoplay = false;

		} else {
			sldrAutoplayTimeout = sldrAutoplay;
			sldrAutoplay = true;
		}

		if( sldrItems === 1 ) {
			sldrItemsDesktop = 1,
			sldrItemsTablet = 1;
		}

	


	// Main Carousel Function
	$('.infinity-carousel').owlCarousel({
		slideBy: sldrslideby,
		items:sldrItems,
	    loop:sldrLoop,
	    stagePadding: sldrStagePadding,
	    margin:sldrMargin,
	    autoplay:sldrAutoplay,
	    autoplayTimeout:sldrAutoplayTimeout,
	    autoplayHoverPause: true,
	    controlsClass: 'carousel-controls center-width',
	    navContainerClass: 'carousel-nav',
	    navClass: ['carousel-prev','carousel-next'],
	    dotsClass: 'carousel-pagination',
	    dotClass: 'carousel-pagination-item',
		nav: sldrNavigation,
		video:true,
		navText: ['',''],
		dots: sldrPagination,
		onResized: CarouselvideoHeght,
		responsiveClass:true,
	    responsive:{
	        0:{
	            items:1,
			    stagePadding: 0,
			    margin:0,
			    dots: false,
	        },
	        768:{
	            items:sldrItemsTablet,
	            stagePadding: 0,
			    margin:0
	        },
	        979:{
	            items:sldrItemsDesktop
	        },
	        1199:{
	            items:sldrItems
	        }
	    },
	   	smartSpeed: 600
	 });
    }

	// Carousel Video Post Height
	function CarouselvideoHeght() {
		var sldrHeight = Math.round( ( $('.infinity-carousel .owl-item').width() * $('.infinity-carousel-wrap').data('height') )/ $('.infinity-carousel-wrap').data('width') );
		$('.carousel-video-item').css( 'height', sldrHeight );
	}
	CarouselvideoHeght();

	// Remove Carousel Wrap Height
	$('.infinity-carousel-wrap').css( 'height', 'auto' );
	
	// Gallery Post Format Carousel 
	$(".entry-gallery").owlCarousel({
		items: 1,
		loop: $(".entry-gallery").children().length > 1,
		autoHeight:true,
		dots: false,
		nav: true,
		controlsClass: 'gallery-controls center-width',
	    navContainerClass: 'gallery-nav',
	    navClass: ['gallery-prev','gallery-next'],
	    dotsClass: 'gallery-pagination',
	    dotClass: 'gallery-pagination-item',
		navText: ['','']
	});

	// Search  FadeIn
	$('.search-btn').on( 'click', function() {
		$('.header-search-wrap').fadeIn(500);
		$( ".header-search-wrap input" ).focus();
	});

	// Search  Fadeout 
	$('.header-search-wrap').on( 'click', function(event) {
		if ( event.target.className !=='search_input' &&  event.target.className !=='fa fa-search' &&  event.target.className !== 'submit' ) {
			$('.header-search-wrap').fadeOut(500);
		}		
	});

	// header slide toggle
	$('.nav-toggle-btn').on('click', function () {
	    $('.mobile-nav').slideToggle();
	});

	var fixedSidebar =  $( ".fixed-sidebar" ).data('width');
	// Plus Sidebar Open
	$('.sidebar-btn').on('click', function () {
		$('.main-wrap').css( 'margin-left','-'+ fixedSidebar +'px' );
		$('.fixed-header-bottom').css( 'left','-'+ fixedSidebar +'px' );
		$('.fixed-sidebar').css( 'right','0' );
		$('.fixed-sidebar-close').fadeIn(350);
		$('.sidebar-btn').css({
			'-webkit-transform' : 'rotate(45deg)',
			'-moz-transform' : 'rotate(45deg)',
			'-ms-transform' : 'rotate(45deg)',
			'transform' : 'rotate(45deg)'
		});
	});

	// Plus Sidebar Close
	$(' .fixed-sidebar-close, .fixed-sidebar-close-btn ').on('click', function () {
		$('.main-wrap').css( 'margin-left','0' );
		$('.fixed-header-bottom').css( 'left','0' );
		$('.fixed-sidebar').css( 'right','-'+fixedSidebar+'px' );
		$('.fixed-sidebar-close').fadeOut(350);
		$('.sidebar-btn').css({
			'-webkit-transform' : 'rotate(0deg)',
			'-moz-transform' : 'rotate(0deg)',
			'-ms-transform' : 'rotate(0deg)',
			'transform' : 'rotate(0deg)'
		});
	});

	var disableGalleryLightbox = $( ".main-container-wrap" ).data('gallery-lightbox');

	if ( disableGalleryLightbox !== true ) {
		// Wordpress Default Gallery LightBox 
		$('.gallery').magnificPopup({	
			delegate: 'a[href*="wp-content/uploads"]',
			type: 'image',
			mainClass: 'mfp-with-zoom mfp-img-mobile',
			zoom: {
				enabled: true,
				duration: 300
			},
			gallery: {
				enabled: true,
				tCounter: '<span class="mfp-counter">%curr%/%total%</span>'
			},
			image: {
				verticalFit: true
			}
		});
	}

	var disableImageLightbox = $( ".main-container-wrap" ).data('image-lightbox');

	if ( disableImageLightbox !== true ) {

		// Wordpress Defult Image LightBox 
		var  wpImgLightbox = $('img[class*="wp-image"]').parent('a[href*="wp-content/uploads"]');
		$(wpImgLightbox).magnificPopup({
			type: 'image',
			midClick: true,
			closeOnContentClick: true,
			fixedContentPos: true,
			image: {
				verticalFit: true,
				titleSrc: function(item) {
					return '<strong>' + item.el.find('img').attr('alt') + '</strong>';
				}
			},
			zoom: {
				enabled: true,
				duration: 300
			}
		});
	}

	// Standart & Image Format Lightbox
	$( '.infinity-lightbox' ).magnificPopup({
		type: 'image',
		midClick: true,
		closeOnContentClick: true,
		fixedContentPos: true,
		image: {
			verticalFit: true
		},
		zoom: {
			enabled: true,
			duration: 300
		}
	});

	// Site Transition Effect
	if( $('body').hasClass('animsition') ) {
		// create animsition links
	  	$('body').find('a[href*="'+ $('.logo a').attr('href') +'"]').addClass('animsition-link');
		$('.infinity-lightbox, a[href*="wp-content/uploads"], .meta-share a, .post-comment').removeClass('animsition-link');

		$(".animsition").animsition({
			inClass: 'fade-in',
			outClass: 'fade-out',
			inDuration: 600,
			outDuration: 600,
			linkElement: '.animsition-link',
			loading: false,
			loadingParentElement: 'body', 
			loadingClass: 'animsition-loading',
			loadingInner: '', 
			timeout: false,
			timeoutCountdown: 5000,
			onLoadEvent: true,
			browser: [ 'animation-duration', '-webkit-animation-duration'],
			overlay : false,
			overlayClass : 'animsition-overlay-slide',
			overlayParentElement : 'body',
			transition: function(url){ window.location.href = url; }
		});
	}

	// Comment Form 
	if( $('.comment-form').children().first().hasClass('custom-textarea') ) {
		$('.form-submit').before( $('.custom-textarea').clone() );
		$('.custom-textarea:first').remove();
	}

	// Instagram Columns
	var instagram = $( '.footer-instagram .null-instagram-feed li a' ),
	instagramColumn = $( '.footer-instagram .null-instagram-feed li' ).length;
	instagram.css( "width", "calc((100%  /"+ instagramColumn +")" );
	instagram.css( "width", "-webkit-calc((100% /"+ instagramColumn +")" );
	$('.null-instagram-feed').addClass('inst-col-'+instagramColumn);
	
}); // end dom ready